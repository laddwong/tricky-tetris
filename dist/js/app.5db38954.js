(function(t){function n(n){for(var r,c,a=n[0],s=n[1],u=n[2],f=0,d=[];f<a.length;f++)c=a[f],Object.prototype.hasOwnProperty.call(i,c)&&i[c]&&d.push(i[c][0]),i[c]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);l&&l(n);while(d.length)d.shift()();return o.push.apply(o,u||[]),e()}function e(){for(var t,n=0;n<o.length;n++){for(var e=o[n],r=!0,a=1;a<e.length;a++){var s=e[a];0!==i[s]&&(r=!1)}r&&(o.splice(n--,1),t=c(c.s=e[0]))}return t}var r={},i={app:0},o=[];function c(n){if(r[n])return r[n].exports;var e=r[n]={i:n,l:!1,exports:{}};return t[n].call(e.exports,e,e.exports,c),e.l=!0,e.exports}c.m=t,c.c=r,c.d=function(t,n,e){c.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,n){if(1&n&&(t=c(t)),8&n)return t;if(4&n&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(c.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var r in t)c.d(e,r,function(n){return t[n]}.bind(null,r));return e},c.n=function(t){var n=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(n,"a",n),n},c.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},c.p="/tricky-tetris/dist/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],s=a.push.bind(a);a.push=n,a=a.slice();for(var u=0;u<a.length;u++)n(a[u]);var l=s;o.push([0,"chunk-vendors"]),e()})({0:function(t,n,e){t.exports=e("56d7")},"034f":function(t,n,e){"use strict";var r=e("85ec"),i=e.n(r);i.a},4716:function(t,n,e){},"4b12":function(t,n,e){},"56d7":function(t,n,e){"use strict";e.r(n);e("e260"),e("e6cf"),e("cca6"),e("a79d");var r=e("2b0e"),i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{style:"margin-left: -"+t.marginLeft+"px; margin-top: -"+t.marginTop+"px; transform-origin: right bottom ;transform: scale("+t.scale+");",attrs:{id:"app"}},[e("div",[e("Game")],1)])},o=[],c=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"game-container"},[t.bannerText?e("div",{staticClass:"banner"},[e("button",{on:{"~click":function(n){return t.startGame(n)}}},[t._v(t._s(t.bannerText))])]):t._e(),t._m(0),e("div",{staticClass:"play-and-info-container"},[e("Playground",{ref:"playground",attrs:{gameSpeed:t.gameSpeed},on:{landing:t.nextBrick,gameOver:function(n){t.bannerText="Click to restart"}}}),e("GameInfo",{attrs:{score:t.score,count:t.count,level:Math.floor((1e3-t.gameSpeed)/100)}})],1),e("div",{staticClass:"controler-container"},[e("Controler",{on:{rotate:function(n){return t.$refs.playground.rotate()},fall:function(n){return t.$refs.playground.fall()},move:t.move}})],1)])},a=[function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"title"},[e("h1",[t._v("—— Vue Tetris ——")])])}],s=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"playground-container"},[e("table",[e("tbody",t._l(t.displayBoard,(function(n,r){return e("tr",{key:r+"row"},t._l(n,(function(t,n){return e("td",{key:n+"cell"},[e("div",{class:{active:t,default:!0}})])})),0)})),0)])])},u=[],l=(e("cb29"),e("4160"),e("c975"),e("13d5"),e("a434"),e("159b"),e("ac1f"),e("466d"),function(t,n){var e=t.row,r=t.col;this.type=n,this.brick=[],this[n+"Init"](e,r)});l.prototype.OInit=function(t,n){this.brick=[[t,n],[t,n+1],[t+1,n],[t+1,n+1]]},l.prototype.IInit=function(t,n){this.brick=[[t,n],[t,n-1],[t,n+1],[t,n+2]]},l.prototype.JInit=function(t,n){this.brick=[[t,n],[t,n-1],[t,n+1],[t+1,n-1]]},l.prototype.LInit=function(t,n){this.brick=[[t,n],[t,n-1],[t,n+1],[t+1,n+1]]},l.prototype.SInit=function(t,n){this.brick=[[t,n],[t,n-1],[t-1,n],[t-1,n+1]]},l.prototype.ZInit=function(t,n){this.brick=[[t,n],[t,n+1],[t-1,n],[t-1,n-1]]},l.prototype.TInit=function(t,n){this.brick=[[t,n],[t,n-1],[t,n+1],[t-1,n]]};var f=["O","I","J","L","S","Z","T"];function d(t){for(var n=[],e=0;e<t.length;e++)Array.isArray(t[e])?n[e]=d(t[e]):n[e]=t[e];return n}function h(t){for(var n=[],e=0;e<t.row;e++)n.push(new Array(t.col).fill(0));return n}function p(){return f[Math.floor(Math.random()*f.length)]}function b(){return navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)}var v={row:20,col:12},m={name:"playground",props:["gameSpeed"],data:function(){return{board:h({col:v.col,row:v.row}),newBrick:{},intervalObj:-1}},methods:{createBrick:function(){var t=this;this.newBrick=new l({row:1,col:4},p()),this.intervalObj=setInterval((function(){t.fall()}),this.gameSpeed)},move:function(t){for(var n="ArrowLeft"===t?-1:1,e=d(this.newBrick.brick),r=0;r<e.length;r++)e[r][1]+=n;this.check(e)&&(this.newBrick.brick=e)},fall:function(){for(var t=d(this.newBrick.brick),n=0;n<t.length;n++)t[n][0]++;this.check(t)?this.newBrick.brick=t:(clearInterval(this.intervalObj),this.landing())},rotate:function(){if("O"!==this.newBrick.type&&"I"!==this.newBrick.type){var t=[[0,0,0],[0,0,0],[0,0,0]],n=this.newBrick.brick[0][0]-1,e=this.newBrick.brick[0][1]-1;this.newBrick.brick.forEach((function(r){t[r[0]-n][r[1]-e]=1}));for(var r=[],i=0;i<t.length;i++)for(var o=0;o<t[i].length;o++)1===t[i][o]&&(1===i&&1===o?r.unshift([o+n,t.length-i-1+e]):r.push([o+n,t.length-i-1+e]));this.check(r)&&(this.newBrick.brick=r)}if("I"===this.newBrick.type){var c=this.newBrick.brick[0][0],a=this.newBrick.brick[0][1],s=[];s=this.newBrick.brick[0][0]===this.newBrick.brick[1][0]?[[c,a],[c-1,a],[c+1,a],[c+2,a]]:[[c,a],[c,a-1],[c,a+1],[c,a+2]],this.check(s)&&(this.newBrick.brick=s)}},check:function(t){for(var n=0;n<t.length;n++){var e=t[n][0],r=t[n][1];if(!this.board[e]||0!==this.board[e][r])return!1}return!0},landing:function(){for(var t=this,n=0;n<this.newBrick.brick.length;n++){var e=this.newBrick.brick[n][0],r=this.newBrick.brick[n][1];this.$set(this.board[e],r,1)}var i=0;this.board.forEach((function(n,e){n.reduce((function(t,n){return t+n}))===v.col&&(i++,t.board.splice(e,1),t.board.unshift(new Array(v.col).fill(0)))})),-1===this.board[0].indexOf(1)?this.$emit("landing",i):this.$emit("gameOver")},restart:function(){this.board=h({row:v.row,col:v.col})}},computed:{displayBoard:function(){var t=d(this.board);return this.newBrick.brick&&this.newBrick.brick.forEach((function(n){t[n[0]][n[1]]=1})),t}},mounted:function(){var t=this;document.onkeydown=function(n){if("Space"!==n.code){if(-1!==n.key.indexOf("Arrow")){if("ArrowUp"===n.key)return void t.rotate();if("ArrowDown"===n.key)return void t.fall();t.move(n.key)}}else t.rotate()}}},k=m,g=(e("7bca"),e("2877")),w=Object(g["a"])(k,s,u,!1,null,"3ddff653",null),y=w.exports,B=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"container"},[e("p",[t._v("得分")]),e("p",[t._v(t._s(t.score))]),e("p",[t._v("消除行")]),e("p",[t._v(t._s(t.count))]),e("p",[t._v("等级")]),e("p",[t._v(t._s(t.level))])])},_=[],O=(e("a9e3"),{name:"GameInfo",props:{score:Number,count:Number,level:Number}}),x=O,$=(e("b7d4"),Object(g["a"])(x,B,_,!1,null,"34451410",null)),C=$.exports,I=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"control-container"},[e("div",{staticClass:"cross-container"},[e("table",[e("tr",[e("td"),e("td",[e("button",{staticClass:"cross",on:{click:function(n){return t.$emit("rotate")},touchstart:function(n){return t.$emit("rotate")}}})]),e("td")]),e("tr",[e("td",[e("button",{staticClass:"cross",on:{click:function(n){return t.$emit("move","ArrowLeft")}}})]),e("td"),e("td",[e("button",{staticClass:"cross",on:{click:function(n){return t.$emit("move","ArrowRight")}}})])]),e("tr",[e("td"),e("td",[e("button",{staticClass:"cross",on:{click:function(n){return t.$emit("fall")}}})]),e("td")])])]),e("div",{staticClass:"shift-button"},[e("button",{on:{click:function(n){return t.$emit("rotate")}}})])])},S=[],j={name:"Controler"},T=j,E=(e("a1fd"),Object(g["a"])(T,I,S,!1,null,"44bf8d3d",null)),A=E.exports,P={name:"Game",components:{Playground:y,GameInfo:C,Controler:A},data:function(){return{gameSpeed:900,bannerText:"Click to start",score:0,count:0}},methods:{nextBrick:function(t){this.count+=t,this.gameSpeed-=10*t,this.score+=t*(t+9),this.$refs.playground.createBrick()},startGame:function(){"Click to restart"===this.bannerText&&this.$refs.playground.restart(),this.bannerText="",this.$refs.playground.createBrick()},move:function(t){this.$refs.playground.move(t)}}},M=P,G=(e("f074"),Object(g["a"])(M,c,a,!1,null,"67c2eaeb",null)),L=G.exports,J={name:"App",components:{Game:L},data:function(){return{scale:1,marginLeft:0,marginTop:0}},mounted:function(){if(b()){var t=document.documentElement.clientWidth,n=document.documentElement.clientHeight,e=t/500;n<810*e&&(this.scale=n/(810*e),this.marginTop=810*e-n,this.marginLeft=t*(1-this.scale)),document.documentElement.addEventListener("touchend",(function(t){t.preventDefault(),t.target.click()}))}}},N=J,W=(e("034f"),Object(g["a"])(N,i,o,!1,null,null,null)),D=W.exports;r["a"].config.productionTip=!1,new r["a"]({render:function(t){return t(D)}}).$mount("#app")},"7bca":function(t,n,e){"use strict";var r=e("4b12"),i=e.n(r);i.a},"85ec":function(t,n,e){},a1fd:function(t,n,e){"use strict";var r=e("c10a"),i=e.n(r);i.a},b7d4:function(t,n,e){"use strict";var r=e("cd0c"),i=e.n(r);i.a},c10a:function(t,n,e){},cd0c:function(t,n,e){},f074:function(t,n,e){"use strict";var r=e("4716"),i=e.n(r);i.a}});
//# sourceMappingURL=app.5db38954.js.map